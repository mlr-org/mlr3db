<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>DataBackend for Polars — DataBackendPolars • mlr3db</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DataBackend for Polars — DataBackendPolars"><meta name="description" content="A mlr3::DataBackend using RPolarsLazyFrame from package polars.
Can be easily constructed with as_polars_backend().
mlr3::Tasks can interface out-of-memory files if the polars::RPolarsLazyFrame was imported using a polars::scan_x function.
Streaming, a polars alpha feature, is always enabled, but only used when applicable.
A connector is not required but can be useful e.g. for scanning larger than memory files"><meta property="og:description" content="A mlr3::DataBackend using RPolarsLazyFrame from package polars.
Can be easily constructed with as_polars_backend().
mlr3::Tasks can interface out-of-memory files if the polars::RPolarsLazyFrame was imported using a polars::scan_x function.
Streaming, a polars alpha feature, is always enabled, but only used when applicable.
A connector is not required but can be useful e.g. for scanning larger than memory files"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3db</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.5.1-9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-alt"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-link"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3db/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/"><span class="fa fa-rss"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DataBackend for Polars</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3db/blob/main/R/DataBackendPolars.R" class="external-link"><code>R/DataBackendPolars.R</code></a></small>
      <div class="d-none name"><code>DataBackendPolars.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A <a href="https://mlr3.mlr-org.com/reference/DataBackend.html" class="external-link">mlr3::DataBackend</a> using <code>RPolarsLazyFrame</code> from package <a href="https://CRAN.R-project.org/package=polars" class="external-link"><span class="pkg">polars</span></a>.
Can be easily constructed with <code><a href="as_polars_backend.html">as_polars_backend()</a></code>.
<a href="https://mlr3.mlr-org.com/reference/Task.html" class="external-link">mlr3::Task</a>s can interface out-of-memory files if the <code><a href="https://pola-rs.github.io/r-polars/man/LazyFrame_class.html" class="external-link">polars::RPolarsLazyFrame</a></code> was imported using a <code>polars::scan_x</code> function.
Streaming, a <a href="https://CRAN.R-project.org/package=polars" class="external-link"><span class="pkg">polars</span></a> alpha feature, is always enabled, but only used when applicable.
A connector is not required but can be useful e.g. for scanning larger than memory files</p>
    </div>


    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://pola-rs.github.io/r-polars/" class="external-link">https://pola-rs.github.io/r-polars/</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="super-class">Super class<a class="anchor" aria-label="anchor" href="#super-class"></a></h2>
    <p><code><a href="https://mlr3.mlr-org.com/reference/DataBackend.html" class="external-link">mlr3::DataBackend</a></code> -&gt; <code>DataBackendPolars</code></p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>levels</code></dt>
<dd><p>(named <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>)<br>
List (named with column names) of factor levels as <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>.
Used to auto-convert character columns to factor variables.</p></dd>


<dt><code>connector</code></dt>
<dd><p>(<code>function()</code>)<br>
Function which is called to re-connect in case the connection became invalid.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>rownames</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>)<br>
Returns vector of all distinct row identifiers, i.e. the contents of the primary key column.</p></dd>


<dt><code>colnames</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Returns vector of all column names, including the primary key column.</p></dd>


<dt><code>nrow</code></dt>
<dd><p>(<code>integer(1)</code>)<br>
Number of rows (observations).</p></dd>


<dt><code>ncol</code></dt>
<dd><p>(<code>integer(1)</code>)<br>
Number of columns (variables), including the primary key column.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-DataBackendPolars-new"><code>DataBackendPolars$new()</code></a></p></li>
<li><p><a href="#method-DataBackendPolars-data"><code>DataBackendPolars$data()</code></a></p></li>
<li><p><a href="#method-DataBackendPolars-head"><code>DataBackendPolars$head()</code></a></p></li>
<li><p><a href="#method-DataBackendPolars-distinct"><code>DataBackendPolars$distinct()</code></a></p></li>
<li><p><a href="#method-DataBackendPolars-missings"><code>DataBackendPolars$missings()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="mlr3" data-topic="DataBackend" data-id="format"><a href="https://mlr3.mlr-org.com/reference/DataBackend.html#method-format"><code>mlr3::DataBackend$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="DataBackend" data-id="print"><a href="https://mlr3.mlr-org.com/reference/DataBackend.html#method-print"><code>mlr3::DataBackend$print()</code></a></span></li>
</ul></details></p><hr><a id="method-DataBackendPolars-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a backend for a <a href="https://pola-rs.github.io/r-polars/man/DataFrame_class.html" class="external-link">polars::RPolarsDataFrame</a> object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/DataBackendPolars.html">DataBackendPolars</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">primary_key</span>,</span>
<span>  strings_as_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  connector <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>(<a href="https://pola-rs.github.io/r-polars/man/LazyFrame_class.html" class="external-link">polars::RPolarsLazyFrame</a>)<br>
The data object.</p>
<p>Instead of calling the constructor itself, please call <code><a href="https://mlr3.mlr-org.com/reference/as_data_backend.html" class="external-link">mlr3::as_data_backend()</a></code> on
a <a href="https://pola-rs.github.io/r-polars/man/LazyFrame_class.html" class="external-link">polars::RPolarsLazyFrame</a> or <a href="https://pola-rs.github.io/r-polars/man/DataFrame_class.html" class="external-link">polars::RPolarsDataFrame</a>.
Note that only <a href="https://pola-rs.github.io/r-polars/man/LazyFrame_class.html" class="external-link">polars::RPolarsLazyFrame</a>s will be converted to a DataBackendPolars.
<a href="https://pola-rs.github.io/r-polars/man/DataFrame_class.html" class="external-link">polars::RPolarsDataFrame</a> objects without lazy execution will be converted to a
<a href="https://mlr3.mlr-org.com/reference/DataBackendDataTable.html" class="external-link">DataBackendDataTable</a>.</p></dd>


<dt><code>primary_key</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Name of the primary key column.
Because <code>polars</code> does not natively support primary keys, uniqueness of the primary key column is expected but not enforced.</p></dd>


<dt><code>strings_as_factors</code></dt>
<dd><p>(<code>logical(1)</code> || <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Either a character vector of column names to convert to factors, or a single logical flag:
if <code>FALSE</code>, no column will be converted, if <code>TRUE</code> all string columns (except the primary key).
For conversion, the backend is queried for distinct values of the respective columns
on construction and their levels are stored in <code>$levels</code>.</p></dd>


<dt><code>connector</code></dt>
<dd><p>(<code>function()</code>)<br>
Optional function which is called to re-connect to e.g. a source file in case the connection became invalid.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-DataBackendPolars-data"></a><div class="section">
<h3 id="method-data-">Method <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code><a class="anchor" aria-label="anchor" href="#method-data-"></a></h3>
<p>Returns a slice of the data.</p>
<p>The rows must be addressed as vector of primary key values, columns must be referred to via column names.
Queries for rows with no matching row id and queries for columns with no matching
column name are silently ignored.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rows</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>)<br>
Row indices.</p></dd>


<dt><code>cols</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Column names.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-DataBackendPolars-head"></a><div class="section">
<h3 id="method-head-">Method <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code><a class="anchor" aria-label="anchor" href="#method-head-"></a></h3>
<p>Retrieve the first <code>n</code> rows.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>(<code>integer(1)</code>)<br>
Number of rows.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p><code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table::data.table()</a></code> of the first <code>n</code> rows.</p>
</div>

</div><p></p><hr><a id="method-DataBackendPolars-distinct"></a><div class="section">
<h3 id="method-distinct-">Method <code>distinct()</code><a class="anchor" aria-label="anchor" href="#method-distinct-"></a></h3>
<p>Returns a named list of vectors of distinct values for each column
specified. If <code>na_rm</code> is <code>TRUE</code>, missing values are removed from the
returned vectors of distinct values. Non-existing rows and columns are
silently ignored.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">distinct</span><span class="op">(</span><span class="va">rows</span>, <span class="va">cols</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rows</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>)<br>
Row indices.</p></dd>


<dt><code>cols</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Column names.</p></dd>


<dt><code>na_rm</code></dt>
<dd><p>(<code>logical(1)</code>)<br>
Whether to remove NAs or not.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Named <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of distinct values.</p>
</div>

</div><p></p><hr><a id="method-DataBackendPolars-missings"></a><div class="section">
<h3 id="method-missings-">Method <code>missings()</code><a class="anchor" aria-label="anchor" href="#method-missings-"></a></h3>
<p>Returns the number of missing values per column in the specified slice
of data. Non-existing rows and columns are silently ignored.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">missings</span><span class="op">(</span><span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rows</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>)<br>
Row indices.</p></dd>


<dt><code>cols</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Column names.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>Total of missing values per column (named <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>).</p>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">mlr3misc</span><span class="fu">::</span><span class="fu"><a href="https://mlr3misc.mlr-org.com/reference/require_namespaces.html" class="external-link">require_namespaces</a></span><span class="op">(</span><span class="st">"polars"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Backend using a in-memory data set</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">=</span> <span class="va">iris</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">row_id</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">150</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">=</span> <span class="fu">polars</span><span class="fu">::</span><span class="fu"><a href="https://pola-rs.github.io/r-polars/man/as_polars_lf.html" class="external-link">as_polars_lf</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">=</span> <span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, primary_key <span class="op">=</span> <span class="st">"row_id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Object supports all accessors of DataBackend</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="va">nrow</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="va">ncol</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="va">colnames</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">100</span><span class="op">:</span><span class="fl">101</span>, cols <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="fu">distinct</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">rownames</span>, <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Classification task using this backend</span></span></span>
<span class="r-in"><span>  <span class="va">task</span> <span class="op">=</span> <span class="fu">mlr3</span><span class="fu">::</span><span class="va"><a href="https://mlr3.mlr-org.com/reference/TaskClassif.html" class="external-link">TaskClassif</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"iris_polars"</span>, backend <span class="op">=</span> <span class="va">b</span>, target <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Write a parquet file to scan</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="fu">collect</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">write_parquet</span><span class="op">(</span><span class="st">"iris.parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">=</span> <span class="fu">polars</span><span class="fu">::</span><span class="va"><a href="https://pola-rs.github.io/r-polars/man/pl_pl.html" class="external-link">pl</a></span><span class="op">$</span><span class="fu">scan_parquet</span><span class="op">(</span><span class="st">"iris.parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Backend that re-reads the parquet file if the connection fails</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">=</span> <span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="st">"row_id"</span>,</span></span>
<span class="r-in"><span>    connector <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu">polars</span><span class="fu">::</span><span class="va"><a href="https://pola-rs.github.io/r-polars/man/pl_pl.html" class="external-link">pl</a></span><span class="op">$</span><span class="fu">scan_parquet</span><span class="op">(</span><span class="st">"iris.parquet"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Define a backend on a subset of the database: do not use column "Sepal.Width"</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">polars</span><span class="fu">::</span><span class="va"><a href="https://pola-rs.github.io/r-polars/man/pl_pl.html" class="external-link">pl</a></span><span class="op">$</span><span class="fu">col</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="st">"Sepal.Width"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">polars</span><span class="fu">::</span><span class="va"><a href="https://pola-rs.github.io/r-polars/man/pl_pl.html" class="external-link">pl</a></span><span class="op">$</span><span class="fu">col</span><span class="op">(</span><span class="st">"row_id"</span><span class="op">)</span><span class="op">$</span><span class="fu">is_in</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">120</span><span class="op">)</span> <span class="co"># Use only first 120 rows</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Backend with only scanned data</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">=</span> <span class="va">DataBackendPolars</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="st">"row_id"</span>, strings_as_factors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Query disinct values</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="fu">distinct</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">rownames</span>, <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Query number of missing values</span></span></span>
<span class="r-in"><span>  <span class="va">b</span><span class="op">$</span><span class="fu">missings</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">rownames</span>, <span class="va">b</span><span class="op">$</span><span class="va">colnames</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Cleanup</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"iris.parquet"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">"iris.parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;DataBackendPolars&gt; (150x6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species row_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.5          1.4         0.2  setosa      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.0          1.4         0.2  setosa      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.2          1.3         0.2  setosa      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.1          1.5         0.2  setosa      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.6          1.4         0.2  setosa      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.9          1.7         0.4  setosa      6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [...] (144 rows omitted)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;TaskClassif:iris_polars&gt; (150 x 5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Target: Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Properties: multiclass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Features (4):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - dbl (4): Petal.Length, Petal.Width, Sepal.Length, Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;DataBackendPolars&gt; (150x6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species row_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.5          1.4         0.2  setosa      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.0          1.4         0.2  setosa      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.2          1.3         0.2  setosa      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.1          1.5         0.2  setosa      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.6          1.4         0.2  setosa      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA         3.9          1.7         0.4  setosa      6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [...] (144 rows omitted)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;DataBackendPolars&gt; (120x5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sepal.Length Petal.Length Petal.Width Species row_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.4         0.2  setosa      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.4         0.2  setosa      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.3         0.2  setosa      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.5         0.2  setosa      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.4         0.2  setosa      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            NA          1.7         0.4  setosa      6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [...] (114 rows omitted)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michel Lang, Lona Koers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

